<!DOCTYPE html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="{{ url_for('admin.static', filename='css/admin.css') }}" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    
    <script src="https://cdn.jsdelivr.net/npm/codex.editor.header@2.0.4/dist/bundle.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest"></script><!-- Header -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/simple-image@latest"></script><!-- Image -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/delimiter@latest"></script><!-- Delimiter -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/list@latest"></script><!-- List -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/checklist@latest"></script><!-- Checklist -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/quote@latest"></script><!-- Quote -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/code@latest"></script><!-- Code -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/embed@latest"></script><!-- Embed -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/table@latest"></script><!-- Table -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/link@latest"></script><!-- Link -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/warning@latest"></script><!-- Warning -->

    <script src="https://cdn.jsdelivr.net/npm/@editorjs/marker@latest"></script><!-- Marker -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/inline-code@latest"></script><!-- Inline Code -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script><!-- Editor -->

    <style>
        form label {
            display: none;
        }
    </style>
</head>

{% from "includes/formHelper.html" import render_field %}
<body class="ember-application tom-destiny-body-fullscreen">
    <div class="tom-destiny-app">
        <div class="tom-destiny-viewport ">
            <main class="tom-destiny-main editor-new tom-destiny-main-white">
                <div class="flex flex-row">
                    <section id="ember54" class="tom-destiny-editor tom-destiny-view relative ember-view">
                        <header class="tom-destiny-editor-header br2 pe-none">
                            <div class="flex items-center pe-auto h-100">
                                <a href="/admin/posts" id="ember55" class="ember-view tom-destiny-btn-editor tom-destiny-editor-back-button">
                                    <span>
                                        <svg viewBox="0 0 16 16">
                                            <path
                                                d="M12.05 1.303a1 1 0 01-.02 1.414L6.597 8l5.433 5.283a1 1 0 01-1.394 1.434L4.756 9a1.4 1.4 0 01-.423-1 1.39 1.39 0 01.423-1l5.88-5.717a1 1 0 011.414.02z">
                                            </path>
                                        </svg>
                                        Posts
                                    </span>
                                </a>
                                <div class="tom-destiny-editor-post-status">
                                    <span>
                                        <div>
                                            New
                                        </div>
                                    </span>
                                </div>
                            </div>
                        </header>

                        <div class="tom-destiny-koenig-editor relative w-100 vh-100 overflow-x-hidden overflow-y-auto z-0">
                            <div class="tom-destiny-koenig-editor-pane flex flex-column mih-100">
                                <article id="ember59" class="koenig-editor w-100 flex-grow relative center mb0 mt0 ember-view">
                                    <div class="koenig-editor__editor-wrapper">
                                        <div class="koenig-editor__editor __mobiledoc-editor __has-no-content">
                                            <div id="editorjs"></div>
                                            <script>
                                                var editor = new EditorJS({
                                                holder: 'editorjs',
                                                autofocus: true,

                                                tools: {
                                                header: {
                                                    class: Header,
                                                    inlineToolbar: ['marker', 'link'],
                                                    config: {
                                                    placeholder: 'Header'
                                                    },
                                                    shortcut: 'CMD+SHIFT+H'
                                                },

                                                image: SimpleImage,

                                                list: {
                                                    class: List,
                                                    inlineToolbar: true,
                                                    shortcut: 'CMD+SHIFT+L'
                                                },

                                                checklist: {
                                                    class: Checklist,
                                                    inlineToolbar: true,
                                                },

                                                quote: {
                                                    class: Quote,
                                                    inlineToolbar: true,
                                                    config: {
                                                    quotePlaceholder: 'Enter a quote',
                                                    captionPlaceholder: 'Quote\'s author',
                                                    },
                                                    shortcut: 'CMD+SHIFT+O'
                                                },

                                                warning: Warning,

                                                marker: {
                                                    class:  Marker,
                                                    shortcut: 'CMD+SHIFT+M'
                                                },

                                                delimiter: Delimiter,

                                                inlineCode: {
                                                    class: InlineCode,
                                                    shortcut: 'CMD+SHIFT+C'
                                                },

                                                linkTool: LinkTool,

                                                embed: Embed,

                                                table: {
                                                    class: Table,
                                                    inlineToolbar: true,
                                                    shortcut: 'CMD+ALT+T'
                                                },

                                                },

                                                data: {
                                                    blocks: [
                                                        {% for block in data %}
                                                            {{ block | tojson | safe }},
                                                        {% endfor %}
                                                    ]
                                                },

                                                onChange: function(api, event) {
                                                console.log('something changed', event);
                                                }
                                            });

                                            function savelah() {
                                                const hihi = document.getElementById('hihi');

                                                editor.save().then((outputData) => {
                                                    hihi.value = JSON.stringify(outputData);
                                                }).catch((error) => {
                                                    console.log('Saving failed: ', error)
                                                });
                                            }
                                            </script>
                                        </div>
                                    </div>
                                </article>
                            </div>
                        </div>

                        <div class="tom-destiny-editor-wordcount-container">
                            <div class="tom-destiny-editor-wordcount">
                                0 words
                            </div>
                        </div>
                    </section>
                </div>

                <form method="POST" id="form" onsubmit="savelah()">
                    {{ render_field(form.content, id="hihi") }}
                    <button type="submit" class="settings-menu-toggle tom-destiny-btn tom-destiny-btn-editor tom-destiny-btn-icon icon-only tom-destiny-btn-action-icon" title="Settings">
                        <span><svg fill="none" viewBox="0 0 24 24"><path d="M21 2.5H3c-.828 0-1.5.608-1.5 1.357v16.286c0 .75.672 1.357 1.5 1.357h18c.828 0 1.5-.608 1.5-1.357V3.857c0-.75-.672-1.357-1.5-1.357zm-4.5 0v19" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg></span>
                    </button>
                </form>
            </main>
        </div>
    </div>
</body>

</html>